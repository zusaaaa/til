# ITインフラ構成の進化と比較

## 1. オンプレミス構成（1990年代〜2000年代前半）

### 構成例
```
企業のWebサイト構成:
┌─ データセンター/サーバールーム ─┐
│ ┌─ 物理サーバー1 ─┐            │
│ │ OS: Linux       │            │
│ │ App: Apache+PHP │ ←─ ロードバランサー
│ │ CPU: 2core      │            │
│ │ RAM: 4GB        │            │
│ └─────────────────┘            │
│                                │
│ ┌─ 物理サーバー2 ─┐            │
│ │ OS: Linux       │            │
│ │ App: MySQL      │            │
│ │ CPU: 4core      │            │
│ │ RAM: 8GB        │            │
│ └─────────────────┘            │
│                                │
│ ルーター、スイッチ、UPS、空調   │
└──────────────────────────────┘
```

### メリット
- **完全制御**: ハードウェアから OS まで全て自分でコントロール
- **セキュリティ**: データが外部に出ない（物理的に隔離）
- **カスタマイズ性**: 特殊な要件にも柔軟に対応可能
- **レイテンシー**: LAN内通信で超低遅延
- **コンプライアンス**: 規制の厳しい業界では必須の場合も

### デメリット
- **初期投資**: サーバー購入費（1台50万〜数百万円）
- **調達期間**: 発注から導入まで数週間〜数ヶ月
- **運用コスト**: 24時間監視、保守、電気代、空調費
- **専門知識**: インフラエンジニアが必須
- **拡張性**: 容量不足時に物理的な増設が必要
- **障害リスク**: 単一障害点が多い
- **リソース無駄**: ピーク時に合わせた過剰投資

### 歴史的背景
```
当時の課題:
• インターネット普及初期
• クラウドサービスが存在しない
• 企業は独自にインフラ構築するしかない
• Amazon EC2 登場前（2006年以前）
```

---

## 2. 仮想サーバー構成（2006年〜現在）

### 構成例
```
AWS EC2 + RDS 構成:
┌─ AWS リージョン（東京）─────────┐
│ ┌─ VPC ─────────────────────┐ │
│ │ ┌─ パブリックサブネット ─┐  │ │
│ │ │ EC2インスタンス        │  │ │
│ │ │ - t3.medium           │  │ │
│ │ │ - Auto Scaling        │  │ │
│ │ │ - Load Balancer       │  │ │
│ │ └─────────────────────┘  │ │
│ │                          │ │
│ │ ┌─ プライベートサブネット ─┐ │ │
│ │ │ RDS MySQL             │ │ │
│ │ │ - Multi-AZ            │ │ │  
│ │ │ - 自動バックアップ      │ │ │
│ │ └─────────────────────┘ │ │
│ └──────────────────────────┘ │
└─────────────────────────────┘
```

### メリット
- **スピード**: 数分でサーバー起動
- **柔軟性**: 必要な時に必要な分だけ利用
- **コスト効率**: 従量課金、リソース無駄の削減
- **自動化**: Auto Scaling、ロードバランシング
- **高可用性**: Multi-AZ、複数リージョン対応
- **マネージドサービス**: RDS、ELBなどの運用自動化
- **グローバル**: 世界中にすぐデプロイ可能
- **バックアップ**: 自動スナップショット

### デメリット
- **継続課金**: 24時間365日の課金
- **ベンダーロックイン**: AWS依存のリスク
- **学習コスト**: クラウドサービス固有の知識が必要
- **設定複雑性**: VPC、セキュリティグループなど
- **予期しない課金**: 設定ミスでの高額請求
- **インターネット依存**: ネットワーク障害の影響
- **データ主権**: データの物理的所在地が不明確

### 技術的な進歩
```
2006年: Amazon EC2 登場
2009年: Amazon RDS 登場  
2012年: Auto Scaling 一般提供
2014年: Lambda 発表（サーバーレスの始まり）

解決した課題:
✓ 物理サーバーの調達期間
✓ 初期投資の削減
✓ 運用負荷の軽減
✓ スケーラビリティの向上
```

---

## 3. サーバーレス構成（2014年〜現在）

### 構成例
```
完全サーバーレス構成:
┌─ フロントエンド ─┐  ┌─ AWS Managed Services ─┐
│ React/Vue.js    │  │ ┌─ API Gateway ─┐      │
│ ↓               │  │ │ REST API       │      │
│ S3 + CloudFront │─→│ │ 認証/認可       │      │
└─────────────────┘  │ └───────────────┘      │
                     │ ↓                      │
                     │ ┌─ Lambda Functions ─┐ │
                     │ │ ユーザー管理        │ │
                     │ │ 商品管理           │ │
                     │ │ 注文処理           │ │
                     │ └───────────────────┘ │
                     │ ↓                      │
                     │ ┌─ データストア ─────┐ │
                     │ │ DynamoDB          │ │
                     │ │ S3                │ │
                     │ │ ElastiCache       │ │
                     │ └───────────────────┘ │
└────────────────────────────────────────────┘
```

### メリット
- **コスト効率**: 実行時間のみ課金（未使用時は¥0）
- **自動スケール**: 需要に応じて瞬間的にスケール
- **運用レス**: サーバー管理が完全に不要
- **高可用性**: AWSが自動的に冗長化
- **開発速度**: インフラ考慮不要、ビジネスロジックに集中
- **セキュリティ**: AWS管理でパッチ適用自動
- **マイクロサービス**: 機能単位での細かい分割が容易

### デメリット
- **コールドスタート**: 初回実行時の遅延（数秒）
- **実行時間制限**: Lambda は最大15分
- **ベンダーロックイン**: AWS固有の仕様に依存
- **デバッグ困難**: ローカル環境での再現が難しい
- **状態管理**: ステートレス設計が必須
- **学習コスト**: 従来とは全く異なる設計思想
- **複雑性**: 多数のサービス組み合わせによる管理複雑化

### 解決された課題
```
従来の問題点:
❌ サーバーの起動時間
❌ キャパシティプランニング  
❌ サーバーメンテナンス
❌ 使わない時間の課金

サーバーレスの解決:
✅ 瞬間的なスケーリング
✅ 使った分だけの課金
✅ インフラ管理完全自動
✅ 高可用性がデフォルト
```

---

## 実際のコスト比較例

### 中規模Webサイト（月間100万PV）の場合

#### オンプレミス構成
```
初期費用:
- Webサーバー × 2台: 200万円
- DBサーバー × 1台: 150万円  
- ネットワーク機器: 100万円
- 設置・設定費用: 50万円
合計: 500万円

月額運用費:
- 電気代: 5万円
- 回線費: 3万円
- 保守費用: 10万円
- 人件費: 30万円
合計: 48万円/月

3年総コスト: 500 + 48×36 = 2,228万円
```

#### EC2構成
```
初期費用: 0円

月額費用:
- EC2 (t3.medium × 2): 8万円
- RDS (db.t3.small): 4万円
- ELB: 2.5万円
- 監視・その他: 1.5万円
合計: 16万円/月

3年総コスト: 16×36 = 576万円
```

#### サーバーレス構成  
```
初期費用: 0円

月額費用:
- Lambda実行: 2万円
- API Gateway: 1万円
- DynamoDB: 1.5万円
- S3 + CloudFront: 0.5万円
合計: 5万円/月

3年総コスト: 5×36 = 180万円
```

---

## 適用場面別の推奨構成

### スタートアップ・個人開発
```
推奨: サーバーレス
理由:
• 初期費用ゼロ
• 急激なアクセス増にも対応
• 開発速度重視
• 運用リソース不足
```

### 中小企業・SaaS
```
推奨: EC2 + マネージドサービス
理由:
• 既存システムとの親和性
• 段階的なクラウド移行
• コストと機能のバランス
• スキル習得しやすい
```

### 大企業・基幹システム
```
推奨: ハイブリッド構成
理由:
• コンプライアンス要件
• 既存投資の活用
• リスク分散
• 段階的モダナイゼーション
```

### 規制の厳しい業界
```
推奨: オンプレミス + プライベートクラウド
理由:
• データ主権の確保
• 規制対応
• セキュリティ要件
• 完全制御の必要性
```

---

## まとめ：進化の必然性

### 1990年代 → 2000年代前半（オンプレミス時代）
**課題**: インターネット普及、でも選択肢がない
**解決**: 自前でデータセンター構築するしかない

### 2006年〜（仮想化・クラウド時代）
**課題**: 初期投資、調達期間、運用負荷
**解決**: EC2で仮想サーバーをオンデマンド提供

### 2014年〜（サーバーレス時代）
**課題**: サーバー管理、キャパシティプランニング
**解決**: インフラ管理を完全抽象化

### 今後の展望
```
次の進化予測:
• AI/ML統合の自動化
• エッジコンピューティング
• 量子コンピューティング
• さらなる抽象化レイヤー
```

**各時代の技術は現在も併存している理由**:
- 要件によって最適解が異なる
- 既存システムとの互換性
- コスト・リスクの考え方の違い
- 組織の技術成熟度の違い